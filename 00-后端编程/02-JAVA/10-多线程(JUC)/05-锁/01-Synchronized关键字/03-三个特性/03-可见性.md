可见性指的是当一个线程修改了共享变量后，其他线程能够立即得知这个修改

> **缓存** 导致的可见性问题

![](https://youpaiyun.zongqilive.cn/image/20200712144708.png)

- 我们定义的所有变量都储存在**主内存**中
- 每个线程都有自己**独立的工作内存**，里面保存该线程使用到的变量的副本（主内存中该变量的一份拷贝）
- 线程对共享变量所有的操作都必须在自己的工作内存中进行，不能直接从主内存中读写（不能越级）
- 不同线程之间也无法直接访问其他线程的工作内存中的变量，线程间变量值的传递需要通过主内存来进行。（同级不能相互访问）





共享变量可见性的实现原理：

线程1对共享变量的修改要被线程2及时看到的话，要经过如下步骤：

1. 把工作内存1中更新的变量值刷新到主内存
2. 把主内存中的变量的值更新到工作内存2中



> 可以使用 synchronized 、volatile 、final 来保证可见性



















