##  什么是事务

存储引擎必须是`Innodb`

事务用于保证数据的一致性, 由一组相关的`DML语句`组成, 该组的`DML语句`要么全部成功, 要么全部失败.

## 实现事务步骤

![image-20190122085928119](https://ws3.sinaimg.cn/large/006tNc79ly1fzf2zz8penj30fq069gmx.jpg)

### 开始事务

```sql
start transaction;
```

### 做一个保存点

```sql
savepoint a;
```

### 回退到指定的保存点

```sql
 rollback to a; // 回退到某个保存点
 rollback; // 取消全部事务
```

### 正式提交

一旦提交, 之前所有的保存点失效

```sql
commit;
```

## php代码简单实现

![image-20190121065015893](https://ws1.sinaimg.cn/large/006tNc79ly1fzdtn8hdz6j314a0oigv6.jpg)



![image-20190121065322085](https://ws2.sinaimg.cn/large/006tNc79ly1fzdtqgdvzcj310w0h4wo7.jpg)







