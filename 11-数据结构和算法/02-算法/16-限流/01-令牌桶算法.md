思路：匀速的产生令牌，往桶里面丢，每次请求来，看是否有多余的令牌。如果有获取令牌执行正常业务，偌没有限速。

![eK2Iv8.png](https://s2.ax1x.com/2019/07/27/eK2Iv8.png)



![eK2CtI.png](https://s2.ax1x.com/2019/07/27/eK2CtI.png)



![](https://ae01.alicdn.com/kf/Hef0741bab82e47dca17af8bff331a516d.jpg)

通过这种方式可以允许瞬时的大量处理，然后做限速处理。

 

- 请求来的时候先计算目前放入桶中的令牌数，这里计算，就可以不用启动一个线程匀速放置令牌了，这个叫惰性计算。
- 然后计算桶拥有的令牌数。然后获取令牌。做拒绝还是处理动作。

