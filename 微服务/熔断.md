当下游服务因访问压力过大而响应变慢或失败，上游服务为了保护系统整体的可用性，可以暂时切断对下游服务的调用。

这种牺牲局部，保全整体的措施就叫做**熔断**。

如果不采取熔断措施，我们的系统会怎样呢？我们来看一个栗子。

当前系统中有A，B，C三个服务，服务A是上游，服务B是中游，服务C是下游。它们的调用链如下：

![](https://youpaiyun.zongqilive.cn/image/006tKfTcly1g0cx2zy85gj304c085a9x.jpg)

一旦下游服务C因某些原因变得不可用，积压了大量请求，服务B的请求线程也随之阻塞。线程资源逐渐耗尽，使得服务B也变得不可用。紧接着，服务A也变为不可用，整个调用链路被拖垮。

![](https://youpaiyun.zongqilive.cn/image/006tKfTcly1g0cx384gpsj30jo085q36.jpg)

像这种调用链路的连锁故障，叫做**雪崩**。



熔断机制的大体流程

![](https://youpaiyun.zongqilive.cn/image/006tKfTcly1g0cx3ot94sj30b90h5t8z.jpg)

**开启熔断**

在固定时间窗口内，接口调用超时比率达到一个阈值，会开启熔断。进入熔断状态后，后续对该服务接口的调用不再经过网络，直接执行本地的默认方法，达到**服务降级**的效果。



**熔断回复**

熔断不可能是永久的。当经过了规定时间之后，服务将从熔断状态回复过来，再次接受调用方的远程调用。

