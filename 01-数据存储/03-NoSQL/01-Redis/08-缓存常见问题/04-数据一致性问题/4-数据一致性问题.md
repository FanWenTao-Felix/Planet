## **两种策略**

- 先更新数据库，再删除缓存(`Cache Aside Pattern`设计模式)
  - 在高并发下表现优异，在原子性被破坏时表现不如意
    - 删除缓存失败了，那么会导致数据库中是新数据，缓存中是旧数据，数据就出现了不一致
- 先删除缓存，再更新数据库, (更新成功后再删除缓存一次)
  - 在高并发下表现不如意，在原子性被破坏时表现优异
  - 先删除缓存，再修改数据库。如果数据库修改失败了，那么数据库中是旧数据，缓存中是空的，那么数据不会不一致。因为读的时候缓存没有，则读数据库中旧数据，然后更新到缓存中。



# 比较复杂的数据不一致问题分析

数据发生了变更，先删除了缓存，然后要去修改数据库，此时还没修改。一个请求过来，去读缓存，发现缓存空了，去查询数据库，查到了修改前的旧数据，放到了缓存中。随后数据变更的程序完成了数据库的修改。

