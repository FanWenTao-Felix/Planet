## volatile带来的问题

- 可见性带来的问题：总线风暴
  volatile解决可见性原理说了这么多不知道大家有没有一个问题：线程怎么知道volatile变量发生了更新呢？这里就涉及到了总线嗅探机制,现代CPU一般都是多核心，为了避免各个核心之间导致的数据不一致问题，就需要实现缓存一致性协议，总线嗅探机制就是其中的一种。
- 嗅探机制工作原理：
  每个处理器通过监听在总线上传播的数据来检查自己的缓存值是不是过期了，如果处理器发现自己缓存行对应的内存地址修改，就会将当前处理器的缓存行设置无效状态，当处理器对这个数据进行修改操作的时候，会重新从主内存中把数据读到处理器缓存中。
- 如果我们过多的使用volatile关键字，就会增加总线压力，带来总线风暴的问题。