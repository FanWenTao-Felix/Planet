## 产生延迟的原因有哪些?

1. 从机性能差

2. 进行binlog传输的时候, 网络带宽不好, 网络延迟也会造成同步延迟

3. `大事务执行`, 如果主库的一个事务执行了10min, 而binlog的写入要必须等待事务完成之后, 才会传入从机, 那么此时从机开始执行的时候就已经延迟了10min

4. 主库的写操作是顺序IO 写binlog, 从库单线程去主库顺序读取binlog, 从库取到binlog之后在本地执行.

   mysql 的主从复制都是`单线程`操作, 但是由于主库是顺序写, 所以效率很高, 而从库也是顺序读取主库的日志, 效率也是比较高,

   但是当数据拉取回来之后, 就变成了`随机IO操作 `, 此时成本回提高

5. 从库在同步数据的同时, 可能跟其他查询的线程发生锁抢占的情况, 此时也会延迟

6. 当主库的TPS并发非常高, 产生的DDL数量超过了一个线程所承受的范围, 也会延迟

![](https://youpaiyun.zongqilive.cn/image/20200916155742.png)





## 架构方面解决延迟

1. 直接走主库
2. 往主库写数据的时候，可以直接往缓存中写一份,设置一个较短的过期时间,后面可以直接从缓存中读到数据



## 并行复制









并行复制





