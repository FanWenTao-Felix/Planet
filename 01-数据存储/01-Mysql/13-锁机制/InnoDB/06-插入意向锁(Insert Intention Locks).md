插入意向锁，也是间隙锁的一种，在插入记录前，插入操作会先在所插入的索引范围内设置一个插入意向锁。插入意向锁和插入意向锁之间是兼容的，只要插入的键值不同，就不会相互阻塞。但是如果一个区间已经获取了间隙锁或临键锁，会阻塞插入意向锁的获取。



## 下边的实现有待商榷

举例：

假设 有表person，字段有id, name。隔离级别为 Repeatable read。

表内容：

| id   | name |
| ---- | ---- |
| 2    | Ray  |
| 7    | Mike |

- id 为主键或唯一键：

   

| 顺序 | 事务1                             | 事务2                                |
| ---- | --------------------------------- | ------------------------------------ |
| 1    | start transaction;                | start transaction;                   |
| 2    | Select * from person where id >5; |                                      |
| 3    |                                   | Insert into person values (6,’Rose’) |
| 4    |                                   | 阻塞                                 |