## 502

502 Bad Gateway, 一般是由于上游服务的故障引起的；

1. max_children

2. request_terminate_timeout、max_execution_time

   设置的时间短, 当超过这个时间, php-fpm 将 `运行脚本` 和  `Worker进程` 都终止执行,Nginx会发现与自己通信的连接断掉了，就会返回给客户端502错误.

3. 数据库

4. 网关服务是否启动如php-fpm





## 504

访问上游服务超时

PHP-FPM设置的脚本最大执行时间已经够长了，但执行耗时PHP脚本时，发现Nginx报错从502变为504了

可以在nginx的`location`中将下边的3项值调大.

```
fastcgi_connect_timeout      180;
fastcgi_read_timeout            600;
fastcgi_send_timeout            600;
```



