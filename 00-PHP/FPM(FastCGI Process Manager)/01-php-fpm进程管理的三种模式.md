- static : 静态模式，启动时分配固定的worker进程。只需要考虑max_children的数量，数量取决于cpu的个数和应用的响应时间。

  

- ondemand: 按需分配，启动时不分配任何进程，当收到用户请求时才启动进程。 master进程检查work进程的数量是否受限，是否有空闲的work进程，没有就新建work进程。在大流量的系统上master进程会变得繁忙，占用系统cpu资源，不适合大流量环境的部署。

- dynamic: 动态模式，启动时分配固定的进程。伴随着请求数增加，在设定的浮动范围调整worker进程。

```shell
pm = dynamic  //动态进程管理，对于专用服务器，可以设置为static，静态一次性启动最大子进程数，不会变化。

pm.max_children = 50 //最大子进程数，ps aux可以查看

pm.start_servers = 20 //启动服务时会启动的进程数

pm.min_spare_servers = 5 //保证空闲子进程数的最小值，如果空闲进程小于这个值，php-fpm服务会创建新的子进程。

pm.max_spare_servers = 35 //保证空闲子进程数的最大值，如果空闲进程高于这个值，就进行清理。

pm.max_requests = 500  //定义一个子进程最多处理的请求数，达到这个值，进程自动退出。目的是为了控制内存溢出，使内存在一个可控范围内。但是如果设置的很小，有可能多个进程同时达到这个值，同时重启，就会导致PHP停止响应直到重启完毕。设置为0表示一直接受请求。
```

> 一般推荐用static，优点是不用动态的判断负载情况，提升性能，缺点是多占用些系统内存资源。



















