![](https://youpaiyun.zongqilive.cn/image/20200318152440.png)

![](https://youpaiyun.zongqilive.cn/image/20200318152448.png)



## 元空间与永久代最大的区别

永久代使用的是JVM的堆内存, 但是java8之后的元空间并不在虚拟机中, 而是使用本机物理内存.

因此, 默认情况下, 元空间的大小仅受本地内存限制, 类的元数据放入本地内存, 字符串池和类的静态变量放入java堆中, 这样可以加载多少类的元数据就不再由`MaxPermSize`控制, 而是由系统实际可用空间来控制.



![](https://youpaiyun.zongqilive.cn/image/20200318153624.png)



## 堆的参数主要有两个：`-Xms`，`-Xmx`：

`-Xms`: 堆的初始化的大小
`-Xmx`: 堆的最大化
Young Gen(新生代)有一个参数`-Xmn`，这个参数可以调新生区和养老区的比例。但是，这个参数一般不调。



## 注意事项

**实际工作中，初始值和最大值 必须是一致的，原因是避免内存忽高忽低产生停顿**

```
-Xms1024m -Xmx1024m -XX:+PrintGCDetails
```



```java
public static void main(String[] args) {
  long maxMemory = Runtime.getRuntime().maxMemory() ;//返回 Java 虚拟机试图使用的最大内存量。
  long totalMemory = Runtime.getRuntime().totalMemory() ;//返回 Java 虚拟机中的内存总量。
  System.out.println("-Xmx:MAX_MEMORY = " + maxMemory + "（字节）、" + (maxMemory / (double)1024 / 1024) + "MB");
  System.out.println("-Xms:TOTAL_MEMORY = " + totalMemory + "（字节）、" + (totalMemory / (double)1024 / 1024) + "MB");

}
```

![](https://youpaiyun.zongqilive.cn/image/20200318154048.png)

















